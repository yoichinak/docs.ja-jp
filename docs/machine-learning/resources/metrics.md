---
title: ML.NET のメトリック
description: ML.NET モデルのパフォーマンスを評価するために使用されるメトリックを理解する
ms.date: 04/29/2019
author: ''
ms.openlocfilehash: d76cab0b56085ebf2ee69f4d9d12c9685c3cb021
ms.sourcegitcommit: 4c10802ad003374641a2c2373b8a92e3c88babc8
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/08/2019
ms.locfileid: "65452697"
---
# <a name="model-evaluation-metrics-in-mlnet"></a>ML.NET のモデル評価メトリック

## <a name="metrics-for-binary-classification"></a>二項分類のメトリック

| メトリック   |      説明      |  求めるもの |
|-----------|-----------------------|-----------|
| **正確度** |  [正確度](https://en.wikipedia.org/wiki/Accuracy_and_precision#In_binary_classification)は、テスト データ セットでの正しい予測の割合です。 これは、入力サンプルの総数に対する正しい予測数の比率です。 各クラスに属するサンプルの数が同様の場合にのみ適しています。| **1.00 に近いほど優れています**。 ただし、ぴったりの 1.00 は問題を示しています (通常: ラベル/ターゲットの漏えい、過剰適合、またはトレーニング データによるテスト)。 テスト データのバランスが取れていない場合 (ほとんどのインスタンスがいずれかのクラスに属している場合)、データセットが非常に小さいか、スコアが 0.00 または 1.00 に近く、正確度では実際に分類子の有効性がキャプチャされないので、追加のメトリックを確認する必要があります。 |
| **AUC** |    [aucROC](https://en.wikipedia.org/wiki/Receiver_operating_characteristic) または "*曲線下面積*":これは、真陽性率と偽陽性率のスイープによって作成される曲線下面積を測定する処理です。  |   **1.00 に近いほど優れています**。 モデルが許容されるには、0.50 より大きい必要があります。AUC が 0.50 以下のモデルは役に立ちません。 |
| **AUCPR** | [aucPR](https://www.coursera.org/lecture/ml-classification/precision-recall-curve-rENu8) または "*精度 - 再現率曲線の曲線下面積*":クラスが非常に不均衡な (非常に偏ったデータセット) 場合の予測の成功の役に立つ測定。 |  **1.00 に近いほど優れています**。 1.00 に近い高スコアは、分類子が正確な結果を返していること (高精度) と、すべての肯定的な結果の大部分も返していること (高い再現率) を示します。 |
| **F1 スコア** | [F1 スコア](https://en.wikipedia.org/wiki/F1_score)は "*バランスの取れた F スコアまたは F メジャー*" とも呼ばれます。 これは精度と再現率の調和平均です。 F1 スコアは、精度と再現率のバランスを取る場合に役立ちます。| **1.00 に近いほど優れています**。  F1 スコアは 1.00 で最高値に到達し、0.00 で最低スコアに到達します。 分類子の精度がわかります。 |

二項分類メトリックの詳細については、以下の記事を参照してください。

- [正確度、精度、再現率、または F1?](https://towardsdatascience.com/accuracy-precision-recall-or-f1-331fb37c5cb9)
- [BinaryClassificationMetrics クラス](https://docs.microsoft.com/en-us/dotnet/api/microsoft.ml.data.binaryclassificationmetrics?view=ml-dotnet)
- [精度 - 再現率曲線と ROC 曲線の関係](http://pages.cs.wisc.edu/~jdavis/davisgoadrichcamera2.pdf)

## <a name="metrics-for-multi-class-classification"></a>多クラス分類のメトリック

| メトリック   |      説明      |  求めるもの |
|-----------|-----------------------|-----------|
| **マイクロ正確度** |  [マイクロ平均正確度](https://docs.microsoft.com/en-us/dotnet/api/microsoft.ml.data.multiclassclassificationmetrics.microaccuracy?view=ml-dotnet)では、すべてのクラスのコントリビューションを集計して平均メトリックが計算されます。 正しく予測されたインスタンスの割合です。 マイクロ平均には、クラスのメンバーシップが考慮されません。 基本的に、すべてのサンプルとクラスのペアが、精度メトリックに均等に作用します。 | **1.00 に近いほど優れています**。 多クラス分類タスクで、マイクロ正確度の方がマクロ正確度よりも適しているのは、クラスの不均衡があると思われる場合です (言い換えると、 あるクラスが他のクラスよりも例の数が多い場合です)。|
| **マクロ正確度** | [マクロ平均正確度](https://docs.microsoft.com/en-us/dotnet/api/microsoft.ml.data.multiclassclassificationmetrics.macroaccuracy?view=ml-dotnet)はクラス レベルの平均正確度です。 各クラスの正確度が計算され、マクロ正確度はこれらの正確度の平均です。 基本的に、すべてのクラスが、精度メトリックに均等に作用します。 少数派のクラスは、大規模なクラスと同じ重みが与えられています。 マクロ平均メトリックでは、データセットにそのクラスのインスタンスがいくつ含まれていても、各クラスに同じ重みが与えられます。 |  **1.00 に近いほど優れています**。  クラスごとに独立してメトリックを計算してから、平均を受け取ります (そのため、すべてのクラスを平等に扱います)。 |
| **対数損失**| [対数損失](http://wiki.fast.ai/index.php/Log_Loss)では、予測入力が 0.00 と 1.00 の間の確率値である分類モデルのパフォーマンスを測定します。 予測される確率が実際のラベルから分岐すると、対数損失が増加します。 | **0.00 に近いほど、優れています**。 完璧なモデルの対数損失は 0.00 になります。 機械学習モデルの目的はこの値を最小にすることです。|
| **対数損失の減少** | [対数損失の減少](https://docs.microsoft.com/en-us/dotnet/api/microsoft.ml.data.multiclassclassificationmetrics.loglossreduction?view=ml-dotnet)は、ランダム予測よりも優れている分類子の利点と解釈できます。| **範囲は -inf から 1.00 です。ここで、1.00 は完璧な予測であり、0.00 は平均の予測を示します**。 たとえば、値が 0.20 の場合、"正しい予測の確率は、ランダムな推測よりも 20% 優れている" と解釈できます。|

マイクロ正確度は、一般に、ML 予測のビジネス ニーズにより適しています。 多クラス分類タスクの品質を選択するために 1 つのメトリックを選択する場合は、通常、それはマイクロ正確度です。

サポート チケット分類タスクの例: (受け取るチケットをサポート チームに割り当てる)

- マイクロ正確度 -- 受け取るチケットが適切なチームに分類される頻度はどのくらいですか。
- マクロ正確度 -- 平均的なチームの場合、受け取るチケットがそのチームにとって正しい頻度はどのくらいですか。

この例で、マクロ正確度は、小規模なチームには重すぎます。年間 10 枚のチケットのみを取得する小規模なチームが、チケットが年間 10,000 枚の大規模なチームと重要度が同じになります。 このケースのマイクロ正確度は、"チケット ルーティング プロセスを自動化することで、会社がどれくらいの時間/お金を節約できるか" というビジネス ニーズとより相関しています。

多クラス分類メトリックの詳細については、以下の記事を参照してください。

- [精度、再現率、および F スコアのマイクロ平均とマクロ平均](http://rushdishams.blogspot.com/2011/08/micro-and-macro-average-of-precision.html)
- [不均衡なデータセットによる多クラス分類](https://towardsdatascience.com/machine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a)

## <a name="metrics-for-regression"></a>回帰のメトリック

| メトリック   |      説明      |  求めるもの |
|-----------|-----------------------|-----------|
| **R-2 乗** |  [R-2 乗 (R2)](https://en.wikipedia.org/wiki/Coefficient_of_determination)、または "*決定係数*" では、モデルの予測係数が -inf から 1.00 の間の値として表されます。 1.00 は完璧な適合があることを意味します。適合は任意に低くなる可能性があるのでスコアはマイナスになることがあります。 0.00 のスコアは、モデルがラベルの期待値を推測していることを意味します。 R2 では、実際のテスト データ値が予測値にどのくらい近いかを測定します。 | **1.00 に近いほど、高品質です**。 ただし、低い R-2 乗値 (0.50 など) がシナリオにとって完全に正常または十分である場合があり、高い R-2 乗値が常に優れているとは限らず、疑わしい場合もあります。 |
| **絶対損失** |  [絶対損失](https://en.wikipedia.org/wiki/Mean_absolute_error)または "*平均絶対誤差 (MAE)* " では、予測が実際の結果にどのくらい近いかを測定します。 これはすべてのモデルの誤差の平均です。モデルの誤差とは、予測されたラベル値と正確なラベル値の間の絶対的な距離です。 この予測の誤差は、テスト データ セットの各レコードに対して計算されます。 最後に、記録されたすべての絶対誤差について平均値が計算されます。| **0.00 に近いほど、高品質です。** 平均絶対誤差には、測定されるデータと同じスケールが使用される点に注意してください (特定の範囲に正規化されません)。 絶対損失、2 乗損失、および RMS 損失は、同じデータセット、またはラベル値の分布が同様のデータセットのモデル間の比較にのみ使用できます。 |
| **2 乗損失** |  [2 乗損失](https://en.wikipedia.org/wiki/Mean_squared_error)または "*平均 2 乗誤差 (MSE)* " ("*平均 2 乗偏差 (MSD)* " とも呼ばれます) で、回帰直線が一連のテスト データ値にどのくらい近いかがわかります。 これを行うには、点から回帰直線までの距離 (これらの距離が "誤差" です) を受け取り、2 乗します。 2 乗すると、差が大きいほど、重みが大きくなります。 | これは常に負以外であり、**値が 0.00 に近いほど優れています**。 データによっては、平均 2 乗誤差の値を非常に小さくすることができない場合があります。|
| **RMS 損失** |  [RMS 損失](https://en.wikipedia.org/wiki/Root-mean-square_deviation)または "*平均 2 乗誤差平方根 (RMSE)* " ("*平均 2 乗偏差平方根 (RMSD)* " とも呼ばれます) では、モデルによって予測された値と、モデル化されている環境から実際に観察された値の差を測定します。 RMS 損失は 2 乗損失の平方根であり、ラベルと単位が同じです。絶対損失と似ていますが、差が大きいほど、重みが大きくなります。 平均 2 乗誤差平方根は、一般的に、気候学、予測、および回帰分析で実験結果を検証するために使用されます。 | これは常に負以外であり、**値が 0.00 に近いほど優れています**。 RMSD は、スケールに依存するため、データセット間ではなく、特定のデータセットに対する異なるモデルの予測誤差を比較するための正確度の測定です。|

回帰メトリックの詳細については、以下の記事を参照してください。

- [回帰分析:R-2 乗を解釈して適合度を評価する方法](https://blog.minitab.com/blog/adventures-in-statistics-2/regression-analysis-how-do-i-interpret-r-squared-and-assess-the-goodness-of-fit)
- [回帰分析で R-2 乗を解釈する方法](https://statisticsbyjim.com/regression/interpret-r-squared-regression)
- [R-2 乗の定義](https://www.investopedia.com/terms/r/r-squared.asp)
- [平均 2 乗誤差の定義](https://www.statisticshowto.datasciencecentral.com/mean-squared-error/)
- [平均 2 乗誤差と平均 2 乗誤差平方根とは](https://www.vernier.com/til/1014/)
